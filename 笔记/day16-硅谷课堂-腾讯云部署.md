

![](.\images\1.jpg)

## 硅谷课堂第十六天-腾讯云部署

[TOC]

### 一、项目部署方案

#### 1、原始部署方式

![image-20220519141648705](.\images\image-20220519141648705.png)



#### 2、整合Jenkins

> **完整DevOps示例如下：**

![dev-ops](.\images\dev-ops.png)



#### 3、整合CODING

> **整合CODING实现DevOps**

https://console.cloud.tencent.com/coding/container-devops

![img](.\images\process.svg)



### 二、腾讯云CODING DevOps概述

**腾讯云使用文档：**

https://help.coding.net/docs/start/new.html

#### 1、产品简介

DevOps 是 Development 和 Operations 的组合词，代表着重视「软件开发人员(Dev)」和「IT 运维技术人员(Ops)」之间沟通合作的文化；旨在透过自动化「软件交付」和「架构变更」的流程，使得构建、 测试、发布软件的过程能够更加地快捷、频繁和可靠。Gartner 咨询公司认为 DevOps 代表了 IT 文化的变化趋势。

![img](.\images\20211214105628.png)

##### 1.1、CODING DevOps 是什么

CODING DevOps 是面向软件研发团队的一站式研发协作管理平台，提供从需求到设计、开发、构建、测试、发布到部署的全流程协同及研发工具支撑。CODING 解决方案可助力企业实现代码的统一安全管控，并快速实践敏捷开发与 DevOps，提升软件交付质量与速度，降低企业研发成本，实现研发效能升级。

![img](.\images\20210727110654.png)

##### 1.2、CODING DevOps 优势

- **一站式协作平台及研发工具链，提升研发效能**

  CODING 与云端优势相结合，依托业界敏捷项目管理与 DevOps 体系方法融入到产品中，打通研发过程中的工具链孤岛及协作壁垒，覆盖敏捷开发全生命周期，帮助团队实现需求、迭代、开发、测试、持续集成、持续部署全方位研发管理，提升软件研发效能。

- **支持双态研发体系建设，满足多样化业务需求**

  CODING 适用于不同规模的开发团队以及不同类型的软件开发模式（如瀑布模型、敏捷模型），满足多业务场景的协作需求。

- **项目工作流和度量数据可视化，项目管理更轻松**

  CODING 提供可视化看板，支持对代码、项目进度、人员工作量等不同维度输出详尽的数据报告，为团队管理者提供决策依据，调整项目计划和合理安排研发人力。

- **丰富的扩展能力，无缝集成第三方平台**

  CODING 支持无缝集成 GitHub、GitLab 等第三方代码库及各类常见的运维系统和云原生环境，让用户实现跨平台的无缝迁移。

##### 1.3、CODING DevOps 功能特性

CODING DevOps 平台主要提供以下功能特性：

**团队级功能：**

- 团队管理：团队管理员通过可视化的[仪表盘](https://help.coding.net/docs/dashboard/use.html)可以快速掌握团队成员工作数据、监控项目运行状态；通过[团队目标](https://help.coding.net/docs/okr/okr.html)助力团队成员聚焦组织目标，全方位协同执行，凝聚团队战斗力，让战略坚实落地；利用[工作负载](https://help.coding.net/docs/workload/intro.html)统一查看对比成员的工作量和工作安排；利用[研发度量](https://help.coding.net/docs/metric/intro.html)统计并分析团队成员在一段时间内的事项分布、事项概览、代码分布等数据，度量团队成员在周期内完成工作量与工作动态。

**项目级功能：**

- [项目协同](https://help.coding.net/docs/collaboration/intro.html)：软件开发团队可自由选择适合的研发管理模式，支持多项目管理、敏捷迭代管理、需求管理、缺陷跟踪、多维度报表数据等功能。
- [代码仓库](https://help.coding.net/docs/collaboration/intro.html)：提供企业级的 Git/SVN 代码管理服务，支持精细化权限管控、多分支并行开发、多版本管理等功能。
- [代码扫描](https://help.coding.net/docs/code-scan/intro.html)：提供针对不同编程语言的代码扫描方案，支持对扫描规则、度量规则等进行自定义配置。根据代码扫描测试结果，开发人员可及时发现代码缺陷并作出修正，有效管控代码质量。
- [持续集成](https://help.coding.net/docs/ci/intro.html)：提供基于云端的自动化代码构建、测试、分析和部署工作流服务，支持通过模板快速创建构建任务并进行可视化编排，极大提高软件开发团队的构建效率。
- [持续部署](https://help.coding.net/docs/cd/overview.html)：提供全自动化软件部署，可持续、可控地把软件制品在线发布到服务集群中，支持蓝绿分发布、灰度发布（金丝雀发布）等多种发布策略。
- [制品管理](https://help.coding.net/docs/artifacts/intro.html)：提供云端构建产物管理服务，支持云端构建和本地构建推送，可快速索引存档构建物、进行版本控制。
- [测试管理](https://help.coding.net/docs/test-management/start.html)：提供面向敏捷团队的测试一站式云端测试平台，支持可视化的测试规划和多维度的测试报告，满足敏捷团队对测试过程的多样化需求。
- [文档管理](https://help.coding.net/docs/document/wiki.html)：提供灵活易用的文档管理服务，可用于记录整个项目的来龙去脉，展示当前项目状态，也可让项目成员更好地进行文档书写及协作。

![img](.\images\20220324104623.png)



#### 2、使用流程概述

以下流程图展示了 CODING DevOps 软件开发平台的基本操作流程，您可以按照实际需求有选择性阅读。

![img](.\images\20220324104427.png)

![image-20220513083630592](.\images\image-20220513083630592.png)

##### 2.1. 创建或加入团队

如要开始使用 CODING DevOps，您需要先注册创建或接受邀请后加入一个团队。

![img](.\images\20210830110514.png)

##### 2.2. 新建项目

加入团队之后，您可以在团队内创建项目或受他人邀请加入别的项目。“项目”是核心单元，几乎大部分工作都需要在项目中展开。

![img](.\images\20210729102948.png)

##### 2.3. 开始项目协同

项目创建之后，项目经理、开发、测试等不同的项目角色可通过项目协同实现简单高效的项目协作，包含迭代管理、需求管理、任务管理等。

![img](.\images\20210615104232.png)

##### 2.4. 使用代码仓库

完成项目规划之后，可利用代码仓库管理项目代码。该功能提供企业级的基于 Git 的云端代码管理服务，支持精细化权限管控、多分支并行开发、多版本管理等功能。

![img](.\images\20210729160941.png)

##### 2.5. 启动代码扫描

对于使用 CODING 代码仓库管理的代码，开发者可使用代码扫描功能进行代码检查，以便及时发现代码缺陷并作出修正，有效管控代码质量。

![img](.\images\20210729182124.png)

##### 2.6. 编译构建

项目代码开发完成之后，可通过持续集成功能快速创建构建任务，将项目代码编译打包成软件包。

![img](.\images\20210730105117.png)

##### 2.7. 管理制品

在您将项目代码构建好之后，可以使用制品管理功能管理构建产物。CODING 支持多种制品库类型，包括 Docker、Maven、Helm 和 npm。

![img](.\images\20210730144527.png)

##### 2.8. 实施持续部署

当您的项目代码已经完成构建，可使用持续部署把控构建之后的项目发布与部署到生产环境中去。

![img](.\images\20210727195619.png)

##### 2.9. 管理测试用例

当您在 CODING 平台创建项目之后，您可以使用面向敏捷团队的测试管理功能来管理项目内的测试活动，确保产品的高质量交付。

![img](.\images\20210729185213.png)

##### 2.10. 管理项目文档

在项目进行中，必然会产生大量的信息，并且需要对这些信息进行记录、传递、分享。文档管理功能提供灵活易用的文档管理服务，可用于记录整个项目的来龙去脉。



### 三、开通CODING DevOps

#### 1、搜索CODING DevOps

**（1）腾讯云搜索CODING-DevOps**

![image-20220513083835475](\images\image-20220513083835475.png)

**（2）进入界面**

![image-20220513083952934](.\images\image-20220513083952934.png)



#### 2、开通账号

（**1）第一次进入没有账号，去开通**

![image-20220512093705420](.\images\image-20220512093705420.png)



**（2）产品授权**

![image-20220512093745784](.\images\image-20220512093745784.png)

![image-20220512093833533](.\images\image-20220512093833533.png)

**（3）输入信息，邮箱验证**

![image-20220512093956052](.\images\image-20220512093956052.png)



#### 3、创建团队

**（1）输入团队名称提交**

![image-20220512094448110](.\images\image-20220512094448110.png)

**（2）开通成功**

![image-20220512094512184](.\images\image-20220512094512184.png)

**（3）点击立即使用，进入**

![image-20220512094641467](.\images\image-20220512094641467.png)

**（4）进入工作台**

![image-20220513084901541](.\images\image-20220513084901541.png)



### 四、使用CODING DevOps

#### 1、创建项目

在 CODING DevOps 平台建立团队之后，团队内成员可按需创建项目。只有项目创建之后，项目成员才能按需使用**项目协同**、**代码仓库**、**持续集成**、**持续部署**等功能。

##### 1.1、点击创建项目

![image-20220513085442205](.\images\image-20220513085442205.png)

##### 1.2、选择项目模板

![image-20220401161548172](.\images\image-20220401161548172.png)

##### 1.3、填写项目基本信息

![image-20220513085759561](.\images\image-20220513085759561.png)

##### 1.4、完成创建

![image-20220513085905120](.\images\image-20220513085905120.png)



#### 2、项目协同

##### 2.1、项目协同初始化

**（1）前往初始化**

![image-20220513090127515](.\images\image-20220513090127515.png)

**（2）配置并开启项目协同**

**选择经典项目管理**

![image-20220401170346140](.\images\image-20220401170346140.png)

![image-20220513090438935](.\images\image-20220513090438935.png)



##### 2.2、项目协同具体实现

![image-20220606141631189](.\images\image-20220606141631189.png)

**（1）点击右上角创建迭代**

![image-20220513090619536](.\images\image-20220513090619536.png)

**（2）填写迭代信息**

![image-20220513090809560](.\images\image-20220513090809560.png)

**（3）点击创建并规划，创建需求**

![image-20220401170830938](.\images\image-20220401170830938.png)

**（4）点击查看详情**

![image-20220513091511060](.\images\image-20220513091511060.png)

**（5）设置迭代详情信息**

![image-20220513091610533](.\images\image-20220513091610533.png)

**（6）效果**

![image-20220513091905459](.\images\image-20220513091905459.png)



#### 3、代码仓库

##### 3.1、添加仓库

![image-20220401172546839](.\images\image-20220401172546839.png)



**（1）填写仓库信息**

![image-20220513104642347](.\images\image-20220513104642347.png)

****

**（2）克隆仓库**

**点击克隆**

![image-20220401172943428](.\images\image-20220401172943428.png)

##### 3.2、克隆代码仓库到本地

**（1）在 Git 客户端中输入克隆命令**

```shell
git clone <您克隆的代码仓库地址>
```

首次拉取后会提示填写凭据，此处填写在注册 CODING 时所使用的邮箱与密码即可

![image-20220513105122191](.\images\image-20220513105122191.png)

命令操作提示成功之后，你可以在本地代码仓库中进行代码修改。

![image-20220513105158588](.\images\image-20220513105158588.png)

##### 3.3、推送本地代码至CODING仓库

（**1）在 Git 客户端，运行以下三条命令将代码推送到 CODING 平台上的代码仓库**

```shell
git add .
git commit -m "<您对本次提交备注的信息>"
git push git仓库地址
```

**（2）创建提交文件**

![image-20220513105845841](.\images\image-20220513105845841.png)

**（3）进入cmd窗口执行**

![image-20220513105813690](.\images\image-20220513105813690.png)

**（4）查看所有的提交记录**
![image-20220513105725642](.\images\image-20220513105725642.png)



##### 3.4、推送项目到代码仓库

**（1）复制两个文件到项目目录**

![image-20220513110139408](.\images\image-20220513110139408.png)

![image-20220513110345995](.\images\image-20220513110345995.png)

**（2）项目路径cmd窗口执行**

![image-20220513110433190](.\images\image-20220513110433190.png)

![image-20220513110604992](.\images\image-20220513110604992.png)

![image-20220513110534740](.\images\image-20220513110534740.png)

**（3）查看效果**

![image-20220513110713394](.\images\image-20220513110713394.png)



#### 4、持续集成

##### 4.1、创建构建计划

![image-20220401174450292](.\images\image-20220401174450292.png)

##### 4.2、选择类型

![image-20220401174553368](.\images\image-20220401174553368.png)

##### 4.3、设置构建信息

![image-20220513124554966](.\images\image-20220513124554966.png)

![image-20220513124648676](.\images\image-20220513124648676.png)

![image-20220513124733749](.\images\image-20220513124733749.png)

![image-20220513124759238](.\images\image-20220513124759238.png)

##### 4.4、修改流程配置

**根据具体需要，自定义执行流程**

![image-20220513124956741](.\images\image-20220513124956741.png)

##### 4.5、立即构建

![image-20220513125040809](.\images\image-20220513125040809.png)

##### 4.6、构建完成

![image-20220513125309986](.\images\image-20220513125309986.png)



#### 5、持续部署（绑定云账号）

##### 5.1、输入账号名称

![image-20220520143328293](.\images\image-20220520143328293.png)



##### 5.2、创建集群，开放外网ip

**（1）创建集群**

**在容器服务中创建集群**

![image-20220520143639634](.\images\image-20220520143639634.png)

![image-20220520143552908](.\images\image-20220520143552908.png)

**（2）开放外网**

![image-20220520143801945](.\images\image-20220520143801945.png)

![image-20220520143837916](.\images\image-20220520143837916.png)

##### 5.3、复制凭证

**（1）复制集群凭证**

![image-20220520143949031](.\images\image-20220520143949031.png)

**（2）复制到云账户**

![image-20220520144030721](.\images\image-20220520144030721.png)



#### 6、持续部署（Kubernetes）

![image-20220516110346105](.\images\image-20220516110346105.png)

##### 6.1、创建部署

![image-20220516100859149](.\images\image-20220516100859149.png)



##### 6.2、集群配置

###### 6.2.1、集群配置

![image-20220516101020739](.\images\image-20220516101020739.png)

###### 6.2.2、镜像配置

**1、选择示例镜像用于测试使用**

**2、可以选择CODING Docker仓库里面自己创建的镜像**

![image-20220516110809166](.\images\image-20220516110809166.png)

![image-20220516110838104](.\images\image-20220516110838104.png)

###### 6.2.3、应用部署

![image-20220516110921117](.\images\image-20220516110921117.png)



##### 6.3、等待发布

![image-20220516111007139](.\images\image-20220516111007139.png)

![image-20220516111034954](.\images\image-20220516111034954.png)



##### 6.4、获取发布地址

![image-20220516111304563](.\images\image-20220516111304563.png)

![image-20220516111332649](.\images\image-20220516111332649.png)

![image-20220516111453491](.\images\image-20220516111453491.png)



##### 6.5、访问测试

![image-20220516111716999](.\images\image-20220516111716999.png)



#### 7、持续部署（腾讯云弹性伸缩）

##### 7.1、创建应用

**（1）在部署控制台创建应用，选择腾讯云弹性伸缩**

![image-20220520144214591](.\images\image-20220520144214591.png)



##### 7.2、创建流程

**（1）点击创建流程**

![image-20220520144331497](.\images\image-20220520144331497.png)

**（2）选择流程**

![image-20220520144426748](.\images\image-20220520144426748.png)

**（3）修改流程内容**

![image-20220520144509916](.\images\image-20220520144509916.png)



##### 7.3、启动执行

![image-20220520144558085](.\images\image-20220520144558085.png)



##### 7.4、集群查看

**（1）执行成功后，集群中查看**

![image-20220520144629401](.\images\image-20220520144629401.png)









